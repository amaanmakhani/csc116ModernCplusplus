#+STARTUP: showall
#+STARTUP: lognotestate
#+TAGS:
#+SEQ_TODO: TODO STARTED DONE DEFERRED CANCELLED | WAITING DELEGATED APPT
#+DRAWERS: HIDDEN STATE
#+TITLE: Strings
#+CATEGORY: 
#+PROPERTY: header-args: lang           :varname value
#+PROPERTY: header-args:sqlite          :db /path/to/db  :colnames yes
#+PROPERTY: header-args:C++             :results output :flags -std=c++14 -Wall --pedantic -Werror
#+PROPERTY: header-args:R               :results output  :colnames yes

* Prelude: chars

- chars can be operated like ints
- a char can be used an a signed int of size 1 byte

#+BEGIN_SRC C++ :main no :flags -std=c++14 -Wall --pedantic -Werror :results output :exports both
#include <iostream>

int main()
{
   char c { 'A'};
   char d { 66};
   std::cout << c << std::endl;
   std::cout << d << std::endl;
   std::cout << int(c) << std::endl;
   c = = 0x20;
   std::cout << c << std::endl;

   return 0;
}

#+END_SRC

#+RESULTS:
#+begin_example
A
B
65
)
#+end_example



#+BEGIN_SRC C++ :main no :flags -std=c++14 -Wall --pedantic -Werror :results output :exports both
#include <iostream>

int main()
{
   char e { '1' };
   std::cout << e << std::endl;
   std::cout << int(e) << std::endl;

   return 0;
}

#+END_SRC

#+RESULTS:
#+begin_example
1
49
A
65
#+end_example


#+BEGIN_SRC C++ :main no :flags -std=c++14 -Wall --pedantic -Werror :results output :exports both
#include <iostream>

int main()
{
   char c { 'A'};
   std::cout << c << std::endl;
   std::cout << int(c) << std::endl;
   c = c+5;
   std::cout << c << std::endl;
   c = '1' * 2;
   std::cout << c << std::endl;
   std::cout << int(' ') << std::endl;
   std::cout << int(c) << std::endl;
   return 0;
}

#+END_SRC

#+RESULTS:
#+begin_example
A
F
b
32
98
#+end_example

* Strings

** Reference
 http://www.cplusplus.com/reference/string/string/

** Tutorial
 https://www.tutorialspoint.com/cplusplus/cpp_strings.htm

** Caveats

In C++ we have two types of strings:

- C type: char[] and char*

#+BEGIN_SRC C++
char filename[] = "myFile.txt";
char *filename = "myFile.txt";
#+END_SRC

- std::string

#+BEGIN_SRC C++
#include <string>

std::string filename {"myFile.txt"};
std::string emptyString {""};
std::string emptyString2 {};

#+END_SRC

- For this course, never, ever, declare a char[] or char*
- Always use std::string
- .size() returns the length of the string
- .empty() returns true is if the string is ""

#+BEGIN_SRC C++ :main no :results output :flags -std=c++14 -Wall --pedantic -Werror :exports both
#include <iostream>
#include <string>

int main()
{
    std::string filename {"filename.txt"};
    std::string emptyString {""};
    std::string another {}; // initializes to empty string
    another = filename;
    std::cout << "Content: " << filename << std::endl;
    std::cout << "Empty: " << emptyString.size() << std::endl;
    if (emptyString.empty()) {
      std::cout << "It is really Empty " << std::endl;
    }
    return 0;
}

#+END_SRC

#+RESULTS:
#+begin_example
Content: filename.txt
Empty: 0
It is really Empty
#+end_example


* We can traverse an array as a sequence of characters:


#+BEGIN_SRC C++ :main no :results output :flags -std=c++14 -Wall --pedantic :exports both
#include <iostream>
#include <string>

int main()
{
    std::string filename {"vic"};
    for(unsigned int i=0;i<filename.size();i++) {
        std::cout << "position " << i << " value " 
                  << filename.at(i) << std::endl;
    }
    std::cout << "1. " << filename << std::endl;

    for(char c : filename) {
        std::cout << "2. Char " << c << std::endl;   
        c++;
    }
    std::cout << "3. " << filename << std::endl;

    return 0;
}

#+END_SRC

#+RESULTS:
#+begin_example
position 0 value v
position 1 value i
position 2 value c
1. vic
2. Char v
2. Char i
2. Char c
3. vic
#+end_example


* We can modify the characters in the string

- using a reference in a for-loop
- use .at()

#+BEGIN_SRC C++ :main no :results output :flags -std=c++14 -Wall --pedantic :exports both
#include <iostream>
#include <string>

int main()
{
    std::string filename {"abc"};
    for(int i=0;i<filename.size();i++) {
       filename.at(i) = 'X'; // notice single quote for characters
    }
    std::cout << "1: " << filename << std::endl;
    for(char &c:filename) {
       c = 'Z'; 
    }
    std::cout << "2: " << filename << std::endl;
    filename.at(0) = 'a';
    filename.at(1) = 'b';
    std::cout << "3: " << filename << std::endl;

    return 0;
}

#+END_SRC

#+RESULTS:
#+begin_example
1: XXX
2: ZZZ
3: abZ
#+end_example

* We can add characters to a string


#+BEGIN_SRC C++ :main no :results output :flags -std=c++14 -Wall --pedantic :exports both
#include <iostream>
#include <string>

int main()
{
    std::string filename {"abc-"};
    // append a string to the end
    filename += "ijk.";
    std::cout << "1. " << filename << std::endl;
    // we can also append characters!
    filename += 'z';
    std::cout << "2. " << filename << std::endl;
    return 0;
}

#+END_SRC

#+RESULTS:
#+begin_example
1. abc-ijk.
2. abc-ijk.z
#+end_example

* Be careful:

A bare sequence between quotes "as in this" is a char array. *Not a string!!*

- Compiler, most of the time, will convert it to std::string as needed
- But sometimes it does not: this program will fail

#+BEGIN_SRC C++ :main no :results output :flags -std=c++14 -Wall --pedantic :exports both
#include <iostream>
#include <string>

int main()
{
    std::string greeting {};

    greeting = "Your name is " + "bob"; // we cannot add one char array to another
    std::cout << greeting << std::endl;
    return 0;
}

#+END_SRC

#+BEGIN_EXAMPLE
/tmp/babel-2558967A/C-src-25589UJI.cpp: In function ‘int main()’:
/tmp/babel-2558967A/C-src-25589UJI.cpp:15:32: error: invalid operands of types ‘const char [14]’ and ‘const char [4]’ to binary ‘operator+’
     greeting = "Your name is " + "bob";
#+END_EXAMPLE

We need first to convert the char array to a std::string then we can add the other

#+BEGIN_SRC C++ :main no :results output :flags -std=c++14 -Wall --pedantic :exports both
#include <iostream>
#include <string>

int main()
{
    std::string greeting {};
    // typecase the char array to a std::string
    greeting = std::string("Your name is ") + "bob"; 
    std::cout << greeting << std::endl;
    return 0;
}

#+END_SRC

#+RESULTS:
#+begin_example
Your name isbob
#+end_example

* Convert a string to numbers

- we need to use special functions to convert a string to an number

#+BEGIN_SRC C++ :main no :results output :flags -std=c++14 -Wall --pedantic :exports both
#include <iostream>
#include <string>

int main()
{
    std::string str1 {"45"};
    std::string str2 {"3.14159"};
    std::string str3 {"31337 with words"};
    std::string str4 {"words and 2"};

    int myint1 { std::stoi(str1) };
    int myint2 { std::stoi(str2) };
    int myint3 { std::stoi(str3) };
   // int myint4 = std::stoi(str4); // this one is invalid, will create an exception
    double myd { std::stod(str2) };
    std::cout << "std::stoi(\"" << str1 << "\") is " << myint1 << '\n';
    std::cout << "std::stoi(\"" << str2 << "\") is " << myint2 << '\n';
    std::cout << "std::stoi(\"" << str3 << "\") is " << myint3 << '\n';
    std::cout << "std::stod(\"" << str2 << "\") is " << myd << '\n';
    
    return 0;
}

#+END_SRC

#+RESULTS:
#+begin_example
std::stoi("45") is 45
std::stoi("3.14159") is 3
std::stoi("31337 with words") is 31337
std::stod("3.14159") is 3.14159
#+end_example

* Compare strings

- Very easy: just use == like any basic type

#+BEGIN_SRC C++ :main no :results output :flags -std=c++14 -Wall --pedantic :exports both
#include <iostream>
#include <string>

int main()
{
    std::string you = "Bob";
    std::string me = "Daniel";    
    std::string he = "Daniel";

    if (me == you) {
        std::cout << "me and you are the same" << std::endl;
    } else {
        std::cout << "me and you are the diffent" << std::endl;
    }

    if (me == he) {
        std::cout << "me and he are the same" << std::endl;
    } else {
        std::cout << "me and he are the diffent" << std::endl;
    }

    return 0;
}

#+END_SRC

#+RESULTS:
#+begin_example
me and you are the diffent
me and he are the same
#+end_example

* Reading strings

This is the input to read

#+BEGIN_EXAMPLE
daniel
#+END_EXAMPLE


#+BEGIN_SRC C++ :main no :results output :flags -std=c++14 -Wall --pedantic :exports both :cmdline < dmg.txt
#include <iostream>
#include <string>

int main()
{
    std::string name {};
    getline(std::cin, name);
    std::cout << "Your name is " + name << std::endl;
    return 0;
}

#+END_SRC

#+RESULTS:
#+begin_example
Your name is daniel
#+end_example


